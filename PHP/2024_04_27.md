- リソースURIのローカライズ
    - Route::resourceはデフォルトで、英語の動詞の複数形のルールを使用してリソースURIを作成する
    - createおよびeditアクション同士をローカライズする必要がある場合は、Route::resourceVerbsメソッドを使用
    - `App\Providers\RouteServiceProvider`内の`boot`メソッドの先頭で実行
    
    ```php
    /**
     * ルートモデルの結合、パターンフィルターなどを定義
     *
     * @return void
     */
    public function boot()
    {
        Route::resourceVerbs([
            'create' => 'crear',
            'edit' => 'editar',
        ]);
    
        // ...
    }
    ```
    
    ```php
    /publicacion/crear
    
    /publicacion/{publicaciones}/editar
    ```
    
- ローカライズは一般的にはアプリケーションの国際化（i18n）や地域化（i10n）に関係したもの

- リソースコントローラへのルート追加
    - デフォルトセットを超えてリソースコントローラーにルートを追加する場合は、Route::resourceメソッドを呼び出す前にルートを定義する必要がある。
    - Route::resourceメソッドを呼び出す前に定義しないと、意図せず補足ルートより優先させる可能性がある。
    
    ```php
    use App\Http\Controller\PhotoController;
    
    Route::get('/photos/popular', [PhotoController::class, 'popular']); //この部分がresourceメソッド以外に追加するルート
    Route::resource('photos', PhotoController::class);
    ```
    
- シングルトンリソースコントローラ
    - アプリケーションが単一インスタンスのリソースを持つ時「シングルトンリソースコントローラー」と呼ばれる。リソースのインスタンスは1つしか存在しないことを意味する。
    - 例としては、ユーザーの「プロフィール」は編集や更新が可能だが、ユーザーが複数の「プロフィール」を持つことはない。同時に、画像は1つの「サムネイル」だけを持つことができる。
    
    ```php
    use App\Http\Controllers\ProfileController;
    use Illuminate\Support\Facades\Route;
    
    Route::singleton('profile', ProfileController::class);
    ```
    
    | 動詞 | URI | アクション | ルート名 |
    | --- | --- | --- | --- |
    | GET | /profile | show | profile.show |
    | GET | /profile/edit | edit | profile.edit |
    | PUT/PATCH | /profile | update | profile.update |
- シングルトン・リソースは、標準リソースの中に入れ子にすることもできる
    
    ```php
    Route::singleton('photos.thumbnail', ThumbnailController::class);
    ```
    
    | 動詞 | URI | アクション | ルート名 |
    | --- | --- | --- | --- |
    | GET | /photos/{photo}/thumbnail | show | photos.thumbnail.show |
    | GET | /photos/{photo}/thumbnail/edit | edit | photos.thumbnail.edit |
    | PUT/PATCH | /photos/{photo}/thumbnail | update | photos.thumbnail.updat |
- シングルトンリソースの作成
    - シングルトンリソースを作成（create）、保存（store）するルートを定義したい場合、creatableメソッドを呼び出す
    
    ```php
    Route::singleton('photos.thumbnail', ThumbnailController::class)->creatable();
    ```
    

    | 動詞 | URI | アクション | ルート名 |
    | --- | --- | --- | --- |
    | GET | /photos/{photo}/thumbnail/create | create | photos.thumbnail.create |
    | POST | /photos/{photo}/thumbnail | store | photos.thumbnail.store |
    | GET | /photos/{photo}/thumbnail | show | photos.thumbnail.show |
    | GET | /photos/{photo}/thumbnail/edit | edit | photos.thumbnail.edit |
    | PUT/PATCH | /photos/{photo}/thumbnail | update | photos.thumbnail.update |
    | DELETE | /photos/{photo}/thumbnail | destroy | photos.thumbnail.destroy |

    - シングルトンリソースのDETELEルートを登録し、作成/保存ルートは登録したくない場合は、destroyableメソッドを利用

    ```php
    Route::singleton(...)->destroyable();
    ```

    ### ビュー

- Laravel ビュー
    - ビューの作成とレンダ
        - アプリケーションの`resource/views`ディレクトリに `.blade.php` 拡張子の付いたファイルを配置することで、ビューを作成できる。
        - ビューを作成したら、グローバルなviewへルパを使用して、アプリケーションのルートまたはコントローラーからビューを返すことができる
        
        ```php
        Route::get('/', function () {
            return view('greeting', ['name' => 'James']);　//コントローラーからビューを返している
        });
        ```
        
        - ビューは、Viewファサードを使用して返すこともできる
        
        ```php
        use Illuminate\Support\Facades\View;
        
        return View::make('greeting', ['name' => 'James']);
        ```
        
        - ご覧の通り、viewへルパに満たす最初の引数はresource/viewsディレクトリ内のビューファイルの名前に対応している。2番目の引数はビューで使用するデータの配列。Blade構文を使用してビューに表示するname変数を渡している。
        - viewファサードはlaravelでビューを操作するための便利なクラス。ビューからインスタンスを取得し、静的な方法で様々な操作を実行できる。
        1. **ビューの取得**: **`view()`** メソッドを使って指定されたビューを取得します。
            
            ```php
            $view = view('welcome');
            ```
            
        2. **ビューにデータを渡す**: ビューに渡すデータは、連想配列として渡すことができます。
            
            ```php
            $view = view('greeting', ['name' => 'James']);
            ```
            
        3. **ビューのレンダリング**: ビューをブラウザに表示するためには、**`render()`** メソッドを使ってビューをレンダリングします。
            
            ```php
            return view('greeting', ['name' => 'James'])->render();
            ```
            
    - ビューにデータを渡す
        - データの配列をビューに渡して、ビューで使用できる
        
        ```php
        return view('greetings', ['name' => 'Victoria']);
        ```
        
        - この方法でデータを渡す場合、キー/値ペアの配列。ビューにデータを渡した後、`<?php echo $name; ?>`などでデータキーを使用
        - データの配列をviewへルパ関数に渡す代わりに、withメソッドを使用して個々のデータをビューへ追加することも可能。
        
        ```php
        return view('greeting')
                    ->with('name', 'Victoria')　//nameが変数、Victoriaが値となる
                    ->with('occupation', 'Astronaut');
        ```
        
    - ビューコンポーザ
        - ビューコンポーザは、ビューをレンダするときに呼び出すコールバックまたはクラスメソッド。
        - ビューをレンダするたびにビューへ結合するデータがある場合、ビューコンポーザを使用すると、そのロジックを1つの場所に集約できる
        - アプリケーション内の複数のルートかコントローラーが同じビューを返し、常に特定のデータが必要な場合に役に立つ
        - アプリケーションのサービスプロバイダのいずれかで登録する。例では`App\Providers\ViewServiceProvider`を作成。
        - Viewファサードのcomposerメソッドを使用して、ビューコンポーザを登録。
        
        ```php
        <?php
        
        namespace App\Providers;
        
        use App\View\Composers\ProfileComposer;
        use Illuminate\Support\Facades\View;
        use Illuminate\Support\ServiceProvider;
        
        class ViewServiceProvider extends ServiceProvider
        {
            /**
             * 全アプリケーションサービスの登録
             *
             * @return void
             */
            public function register()
            {
                //
            }
        
            /**
             * 全アプリケーションサービスの初期起動
             *
             * @return void
             */
            public function boot()
            {
                // クラスベースのコンポーザを使用する
                View::composer('profile', ProfileComposer::class);
        
                // クロージャベースのコンポーザを使用
                View::composer('dashboard', function ($view) {
                    //
                });
            }
        }
        ```
        - コンポーザを登録したので、`profile`ビューがレンダするたびに`App\View\Composers\ProfileComposer`クラスの`compose`メソッドが実行される
        
        ```php
        <?php
        
        namespace App\View\Composers;
        
        use App\Repositories\UserRepository;
        use Illuminate\View\View;
        
        class ProfileComposer
        {
            /**
             * userリポジトリの実装
             *
             * @var UserRepository
             */
            protected $users;
        
            /**
             * 新しいプロフィールコンポーザの生成
             *
             * @param  \App\Repositories\UserRepository  $users
             * @return void
             */
            public function __construct(UserRepository $users)
            {
                $this->users = $users;
            }
        
            /**
             * データをビューと結合
             *
             * @param  \Illuminate\View\View  $view
             * @return void
             */
            public function compose(View $view)
            {
                $view->with('count', $this->users->count());
            }
        }
        ```
